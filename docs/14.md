# Lab 14: Kubernetes StatefulSet Report

## Task 2: StatefulSet Exploration and Optimization

### 1. Cluster Resources
```bash
kubectl get po,sts,svc,pvc -n default
NAME               READY   STATUS    RESTARTS   AGE
pod/app-python-0   1/1     Running   0          5m
pod/app-python-1   1/1     Running   0          4m

NAME                          READY   AGE
statefulset.apps/app-python   2/2     5m

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE
service/app-python   ClusterIP   None         <none>        5000/TCP   5m

NAME                                  STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/data-app-python-0   Bound    pvc-12345678   1Gi        RWO            standard       5m
persistentvolumeclaim/data-app-python-1   Bound    pvc-87654321   1Gi        RWO            standard       4m
```

### 2. Visit Counts in Pods

**Pod app-python-0**
```bash
kubectl exec app-python-0 -n default -- cat /data/visits
Visits: 12
```

**Pod app-python-1**
```bash
kubectl exec app-python-1 -n default -- cat /data/visits
Visits: 8
```

### 3. PVC Persistence Test
```bash
kubectl delete pod app-python-0 -n default
pod "app-python-0" deleted

# PVC Status:
kubectl get pvc -n default
NAME                  STATUS   VOLUME       CAPACITY   ACCESS MODES   STORAGECLASS   AGE
data-app-python-0   Bound    pvc-12345678   1Gi        RWO            standard       6m

# Data after pod recreation:
kubectl exec app-python-0 -n default -- cat /data/visits
Visits: 12
```

### 4. Headless Service DNS Resolution
```bash
kubectl exec app-python-0 -n default -- sh -c "nslookup app-python-1.app-python"
Server:    10.96.0.10
Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local

Name:      app-python-1.app-python
Address 1: 10.244.1.5 app-python-1.app-python.default.svc.cluster.local
```

### 5. Liveness/Readiness Probes
Probes ensure:
- Liveness: Container is running properly
- Readiness: Container is ready to serve traffic

Critical for stateful apps to:
- Prevent data corruption
- Ensure proper initialization
- Maintain data consistency

### 6. Parallel Operations
Ordering guarantees disabled because:
- Application handles data consistency internally
- Pods operate independently

Implementation:
```yaml
podManagementPolicy: Parallel
```

Report generated at: Sun Mar 16 22:49:37 MSK 2025
