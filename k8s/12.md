# Lab 12: ConfigMap Implementation & Application Persistence

## **Task 1: Upgrade Application for Persistence**

### **1. Verify Application Counter Functionality**

After modifying the application to persist visit counts and adding a volume to store the `visits` file, we check if the counter increments.

```bash
kubectl exec -it <pod-name> -- cat /app/visits
```

Example output:

```
Visits: 5
```

Each time we refresh the application, the count increases, proving persistence.

---

## **Task 2: ConfigMap Implementation**

### **1. Create & Apply the ConfigMap**

The `config.json` file was added inside the `files` folder, then converted into a ConfigMap.

```bash

kubectl create configmap my-demo-config --from-file=files/config.json
```

Verify that the ConfigMap was created:

```bash

kubectl get configmap
```

Expected output:

```

NAME               DATA   AGE
my-demo-config     1      10s

```

Check the contents of the ConfigMap:

```bash

kubectl describe configmap my-demo-config
```

Expected output:

```

Name:         my-demo-config
Namespace:    default
Data
====
config.json:
{
    "debug": true,
    "feature_flag": "enabled"
}

```

---

### **2. Verify ConfigMap Mounting in the Pod**

After updating `deployment.yaml` to include **Volume & VolumeMounts**, we verify that the ConfigMap is correctly mounted inside the pod.

```bash

kubectl exec <pod-name> -- cat /app/config.json

```

Expected output:

```json
{
  "debug": true,
  "feature_flag": "enabled"
}
```

This confirms that the ConfigMap is successfully mounted.

---

### **3. Retrieve Pods List to Verify Deployment**

After updating the Helm deployment, list the running pods:

```bash

kubectl get po
```

Example output:

```

NAME                                    READY   STATUS    RESTARTS   AGE
python-app-7c58bdbcc9-mjgqb                 1/1     Running   0          2m30s
```

---

### **4. Confirm Application is Running**

Use `minikube service` to confirm the app is accessible.

```bash
minikube service python-app
```

Example output:

```
Opening service default/python-app in default browser...
```

Check the exposed application:

```bash
curl http://<minikube-ip>:<node-port>
```

Expected output:

```
Hello! Visits: 5
```
