# Kubernetes ConfigMaps

## Upgrade Application for Persistence

I have added /visits endpoint for both apps with respective persistence in file `data/visits`

You can see the results after testing locally using `docker-compose up --build`.

### Python app

```bash
PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> curl http://localhost:8081       


StatusCode        : 200
StatusDescription : OK
RawContent        : HTTP/1.1 200 OK
                    Content-Length: 48
                    Content-Type: application/json
                    Date: Thu, 06 Mar 2025 21:45:39 GMT
                    Server: uvicorn

                    {"Current time in Moscow":"2025-03-07 00:45:39"}
Forms             : {}
Headers           : {[Content-Length, 48], [Content-Type, application/json], [Date, Thu, 06 Mar 2025 21:45:39 GMT], [Server, uvicorn]}
Images            : {}
InputFields       : {}
Links             : {}
ParsedHtml        : mshtml.HTMLDocumentClass
RawContentLength  : 48



PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> curl http://localhost:8081/visits


StatusCode        : 200
StatusDescription : OK
RawContent        : HTTP/1.1 200 OK
                    Content-Type: application/json
                    Date: Thu, 06 Mar 2025 21:45:50 GMT
                    Server: uvicorn

                    {"visits":1}
Forms             : {}
Headers           : {[Content-Length, 12], [Content-Type, application/json], [Date, Thu, 06 Mar 2025 21:45:50 GMT], [Server, uvicorn]}
Images            : {}
InputFields       : {}
Links             : {}
ParsedHtml        : mshtml.HTMLDocumentClass
RawContentLength  : 12



PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> Get-Content -Path .\py_visits_data\visits
1
```

### C# bonus app

```bash
PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> curl http://localhost:8082/


StatusCode        : 200
StatusDescription : OK
Content           : <!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <meta charset="utf-8" />
                        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                        <title>Moscow Time - MoscowTimeApp</title>
                        <li...
RawContent        : HTTP/1.1 200 OK
                    Transfer-Encoding: chunked
                    Content-Type: text/html; charset=utf-8
                    Date: Thu, 06 Mar 2025 21:46:14 GMT
                    Server: Kestrel

                    <html lang="en">
                    <head>
                        <meta charset="...
Forms             : {}
Headers           : {[Transfer-Encoding, chunked], [Content-Type, text/html; charset=utf-8], [Date, Thu, 06 Mar 2025 21:46:14 GMT], [Server, Kestrel]}        
Images            : {}
InputFields       : {}
Links             : {@{innerHTML=MoscowTimeApp; innerText=MoscowTimeApp; outerHTML=<A class=navbar-brand href="/">MoscowTimeApp</A>; outerText=MoscowTimeApp; 
                     tagName=A; class=navbar-brand; href=/}, @{innerHTML=Home; innerText=Home; outerHTML=<A class="nav-link text-dark" href="/">Home</A>; out 
                    erText=Home; tagName=A; class=nav-link text-dark; href=/}, @{innerHTML=Privacy; innerText=Privacy; outerHTML=<A class="nav-link text-dark 
                    " href="/Home/Privacy">Privacy</A>; outerText=Privacy; tagName=A; class=nav-link text-dark; href=/Home/Privacy}, @{innerHTML=Privacy; inn 
                    erText=Privacy; outerHTML=<A href="/Home/Privacy">Privacy</A>; outerText=Privacy; tagName=A; href=/Home/Privacy}}
ParsedHtml        : mshtml.HTMLDocumentClass
RawContentLength  : 2454



PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> curl http://localhost:8082/visits        


StatusCode        : 200
StatusDescription : OK
RawContent        : HTTP/1.1 200 OK
                    Content-Length: 9
                    Content-Type: text/plain
                    Date: Thu, 06 Mar 2025 21:46:19 GMT
                    Server: Kestrel

                    Visits: 3
Forms             : {}
Headers           : {[Content-Length, 9], [Content-Type, text/plain], [Date, Thu, 06 Mar 2025 21:46:19 GMT], [Server, Kestrel]}
Images            : {}
InputFields       : {}
Links             : {}
ParsedHtml        : mshtml.HTMLDocumentClass
RawContentLength  : 9



PS E:\Documents\Innop\C3\S2\devops\S25-core-course-labs\monitoring> Get-Content -Path .\cs_visits_data\visits
3
```

## ConfigMap Implementation

