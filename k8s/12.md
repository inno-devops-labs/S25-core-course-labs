# Kubernetes ConfigMaps

## Upgrade Application for Persistence

- Added endpoint '/visits' for both apps

## ConfigMap Implementation

### Python:

```txt
(venv) ➜  k8s git:(Lab-12) ✗ helm install python-web-app ./python-web-app
NAME: python-web-app
LAST DEPLOYED: Sun Mar  9 23:40:35 2025
NAMESPACE: default
STATUS: deployed
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=python-web-app,app.kubernetes.io/instance=python-web-app" -o jsonpath="{.items[0].metadata.name}")
  echo "Visit http://127.0.0.1:8000 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT
(venv) ➜  k8s git:(Lab-12) ✗ kubectl get po
NAME                              READY   STATUS    RESTARTS   AGE
python-web-app-5bd6fd758f-8w75s   1/1     Running   0          16s
(venv) ➜  k8s git:(Lab-12) ✗ kubectl get configmaps
NAME               DATA   AGE
kube-root-ca.crt   1      1m
py-app-config      1      26s
```

```txt
(venv) ➜  k8s git:(Lab-12) ✗ kubectl exec python-web-app-5bd6fd758f-8w75s -- cat /data/config.json
{
    "String1": "1",
    "String2": "2"
}
```

### Go:

```txt
(venv) ➜  k8s git:(Lab-12) ✗ helm install go-web-app ./go-web-app
NAME: go-web-app
LAST DEPLOYED: Sun Mar  9 23:46:43 2025
NAMESPACE: default
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=go-web-app,app.kubernetes.io/instance=go-web-app" -o jsonpath="{.items[0].metadata.name}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT
(venv) ➜  k8s git:(Lab-12) ✗ kubectl get po
NAME                              READY   STATUS              RESTARTS   AGE
go-web-app-72d81zhr5f-a5kjn   1/1     Running             0          15s
(venv) ➜  k8s git:(Lab-12) ✗ kubectl get configmaps
NAME               DATA   AGE
go-app-config      1      79s
kube-root-ca.crt   1      7m
```

```txt
(venv) ➜  k8s git:(Lab-12) ✗ kubectl exec go-web-app-72d81zhr5f-a5kjn -- cat /data/config.json
{
    "String3": "3",
    "String4": "4"
}
```

## ConfigMap via Environment Variables

### Python:

```txt
(venv) ➜  k8s git:(Lab-12) ✗ kubectl exec python-web-app-5bd6fd758f-8w75s -- printenv config.json
{
    "String1": "1",
    "String2": "2"
}
```

### Go:

```txt
(venv) ➜  k8s git:(Lab-12) ✗ kubectl exec go-web-app-72d81zhr5f-a5kjn -- printenv config.json
{
    "String3": "3",
    "String4": "4"
}
```