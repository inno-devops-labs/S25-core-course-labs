# Kubernetes ConfigMap Implementation

## Implementation Steps

### 1. Created Configuration File

Created a `config.json` file in the `files` folder with application configuration:

```json
{
  "app": {
    "name": "moscow-time-app",
    "version": "1.0.0",
    "environment": "production",
    "timezone": "Europe/Moscow"
  },
  "server": {
    "port": 5000,
    "maxConnections": 100,
    "timeout": 30
  },
  "features": {
    "visitCounter": true,
    "metrics": true,
    "logging": {
      "enabled": true,
      "level": "info"
    }
  }
}
```

### 2. Created ConfigMap Template

Created a `configmap.yaml` Helm template that loads the JSON file using `.Files.Get`:

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-app-config
  labels:
    app: moscow-time-app
    chart: {{ .Chart.Name }}-{{ .Chart.Version }}
    release: {{ .Release.Name }}
data:
  config.json: |-
{{ .Files.Get "files/config.json" | indent 4 }}
```

### 3. Updated Deployment Template

Added volume and volumeMount configurations to the deployment template:

```yaml
spec:
  volumes:
  - name: app-config-volume
    configMap:
      name: {{ .Release.Name }}-app-config
  containers:
  - name: {{ .Chart.Name }}
    volumeMounts:
    - name: app-config-volume
      mountPath: /etc/app-config
      readOnly: true
```

## Verification

### Install Helm Chart

```bash
helm install demo ./moscow-time-chart
```

### Check Pods

```bash
kubectl get pods
```

Output:
```
NAME                                    READY   STATUS        RESTARTS   AGE
demo-moscow-time-app-7dc7b96664-244zd   1/1     Running       0          9s
demo-moscow-time-app-7dc7b96664-6bm4m   1/1     Running       0          9s
demo-moscow-time-app-7dc7b96664-grwn8   1/1     Running       0          11s
```

### Verify ConfigMap Creation

```bash
kubectl get configmaps
```

Output:
```
NAME                  DATA   AGE
demo-app-config       1      2m42s
demo-vault-template   1      110m
kube-root-ca.crt      1      173m
```

### Check ConfigMap Content Inside Pod

```bash
kubectl exec demo-moscow-time-app-7dc7b96664-244zd -- cat /etc/app-config/config.json
```

Output:
```json
{
  "app": {
    "name": "moscow-time-app",
    "version": "1.0.0",
    "environment": "production",
    "timezone": "Europe/Moscow"
  },
  "server": {
    "port": 5000,
    "maxConnections": 100,
    "timeout": 30
  },
  "features": {
    "visitCounter": true,
    "metrics": true,
    "logging": {
      "enabled": true,
      "level": "info"
    }
  }
}
```