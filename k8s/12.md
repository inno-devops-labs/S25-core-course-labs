# Kubernetes ConfigMaps

## Pod shell

```bash
<<K9s-Shell>> Pod: default/propositional-logic-6669f5f475-c6pdl | Container: propositional-logic 
/srv $ cat /config/
..2025_03_09_20_51_30.2766600381/  ..data/                            config.json
/srv $ cat /config/config.json 
{
  "ui-version": "simple",
  "ui-theme": "light"
}/srv $
```

## Pod description

```bash
Containers:
  propositional-logic:
    Container ID:   docker://683a294f7403a489f42f536413db2b41688e6fb4f846fcd11f2c6bd4bf9c09fc
    Image:          fallenchromium/propositional-logic-app:latest
    Image ID:       docker-pullable://fallenchromium/propositional-logic-app@sha256:73ee698091c5b644d87e8ee133e9f1c85189b0d2246ec7e3d77a15eb0e65aa7b
    Port:           8001/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Sun, 09 Mar 2025 23:51:26 +0300
    Ready:          True
    Restart Count:  0
    Limits:
      cpu:     100m
      memory:  128Mi
    Requests:
      cpu:     50m
      memory:  64Mi
    Environment Variables from:
      propositional-logic-env-config  ConfigMap  Optional: false
    Environment:
      APP_PORT:  8080
      APP_HOST:  0.0.0.0
    Mounts:
      /config from config-volume (ro)
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-fbfwc (ro)
```

## Bonus task

### Persistence logic

My second app is a pure web app, so implementing persistence logic is not feasible, I've decided to skip this task.

### ConfigMap via environment variables

envFrom looked a bit weird to me so I've decided to try valueFrom as it's more safe to use it.

```bash
<<K9s-Shell>> Pod: default/propositional-logic-6cb657b4b-5pdsp | Container: propositional-logic 
/srv $ env
VAULT_PORT_8201_TCP_PROTO=tcp
APP_HOST=0.0.0.0
KUBERNETES_SERVICE_PORT=443
KUBERNETES_PORT=tcp://10.43.0.1:443
VAULT_SERVICE_HOST=10.43.129.9
PROPOSITIONAL_LOGIC_PORT_8001_TCP_PORT=8001
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PORT=443
PROPOSITIONAL_LOGIC_PORT_8001_TCP_PROTO=tcp
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PROTO=tcp
HOSTNAME=propositional-logic-6cb657b4b-5pdsp
SHLVL=2
TIME_MOSCOW_SERVICE_PORT_8000_TCP_ADDR=10.43.54.220
PROPOSITIONAL_LOGIC_SERVICE_HOST=10.43.73.181
TIME_MOSCOW_PORT_8000_TCP_ADDR=10.43.27.222
PROPOSITIONAL_LOGIC_APP_SERVICE_PORT_8000_TCP_ADDR=10.43.195.163
HOME=/home/nonroot
VAULT_PORT_8200_TCP=tcp://10.43.129.9:8200
TIME_MOSCOW_SERVICE_PORT_HTTP=8000
CADDY_VERSION=v2.9.1
APP_PORT=8080
VAULT_SERVICE_PORT=8200
VAULT_PORT_8201_TCP=tcp://10.43.129.9:8201
VAULT_PORT=tcp://10.43.129.9:8200
PROPOSITIONAL_LOGIC_APP_SERVICE_PORT_8000_TCP_PORT=8000
TIME_MOSCOW_PORT_8000_TCP_PORT=8000
TIME_MOSCOW_SERVICE_PORT_8000_TCP_PORT=8000
TIME_MOSCOW_SERVICE_PORT_8000_TCP_PROTO=tcp
TIME_MOSCOW_PORT_8000_TCP_PROTO=tcp
PROPOSITIONAL_LOGIC_APP_SERVICE_PORT_8000_TCP_PROTO=tcp
PROPOSITIONAL_LOGIC_PORT_8001_TCP=tcp://10.43.73.181:8001
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT_HTTPS=443
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP=tcp://10.43.121.21:443
PROPOSITIONAL_LOGIC_PORT=tcp://10.43.73.181:8001
VAULT_AGENT_INJECTOR_SVC_SERVICE_HOST=10.43.121.21
PROPOSITIONAL_LOGIC_SERVICE_PORT=8001
PROPOSITIONAL_LOGIC_APP_SERVICE_SERVICE_HOST=10.43.195.163
TIME_MOSCOW_SERVICE_SERVICE_HOST=10.43.54.220
TIME_MOSCOW_SERVICE_HOST=10.43.27.222
TERM=xterm
UI_VERSION=simple
TIME_MOSCOW_SERVICE_PORT_8000_TCP=tcp://10.43.54.220:8000
TIME_MOSCOW_PORT_8000_TCP=tcp://10.43.27.222:8000
PROPOSITIONAL_LOGIC_APP_SERVICE_PORT_8000_TCP=tcp://10.43.195.163:8000
KUBERNETES_PORT_443_TCP_ADDR=10.43.0.1
VAULT_AGENT_INJECTOR_SVC_PORT=tcp://10.43.121.21:443
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT=443
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PROPOSITIONAL_LOGIC_APP_SERVICE_PORT=tcp://10.43.195.163:8000
TIME_MOSCOW_SERVICE_PORT=8000
TIME_MOSCOW_SERVICE_SERVICE_PORT=8000
PROPOSITIONAL_LOGIC_APP_SERVICE_SERVICE_PORT=8000
TIME_MOSCOW_PORT=tcp://10.43.27.222:8000
KUBERNETES_PORT_443_TCP_PORT=443
KUBERNETES_PORT_443_TCP_PROTO=tcp
XDG_CONFIG_HOME=/config
XDG_DATA_HOME=/data
KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443
KUBERNETES_SERVICE_PORT_HTTPS=443
KUBERNETES_SERVICE_HOST=10.43.0.1
VAULT_SERVICE_PORT_HTTP=8200
PWD=/srv
VAULT_PORT_8200_TCP_ADDR=10.43.129.9
VAULT_PORT_8201_TCP_ADDR=10.43.129.9
VAULT_SERVICE_PORT_HTTPS_INTERNAL=8201
VAULT_PORT_8200_TCP_PORT=8200
PROPOSITIONAL_LOGIC_SERVICE_PORT_HTTP=8001
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_ADDR=10.43.121.21
PROPOSITIONAL_LOGIC_PORT_8001_TCP_ADDR=10.43.73.181
VAULT_PORT_8201_TCP_PORT=8201
VAULT_PORT_8200_TCP_PROTO=tcp
/srv $ 
```
