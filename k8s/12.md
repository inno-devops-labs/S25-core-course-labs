# **Lab 12: Kubernetes ConfigMaps**  

---

## **Task 1: Upgrade Application for Persistence**  

### **Verify Changes**
```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\monitoring> docker-compose up --build -d
[+] Building 6.9s (15/15) FINISHED
 ✔ Volume "monitoring_visits_data"  Created                                   0.0s 
 ✔ Container loki                   Created                                   0.0s 
 ✔ Container cadvisor               Created                                   0.0s 
 ✔ Container promtail               Created                                   0.0s 
 ✔ Container moscow-time-app        Started                                  10.3s 
 ✔ Container grafana                Created                                   0.0s 
 ✔ Container prometheus             Created                                   0.0s 
```

### **Check Visit Counter via API**
```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\monitoring> curl http://localhost:5000/visits

StatusCode        : 200
StatusDescription : OK
Content           : Visit count: 1
RawContent        : HTTP/1.1 200 OK
                    Connection: close
                    Content-Length: 14
                    Content-Type: text/html; charset=utf-8
                    Date: Sun, 09 Mar 2025 21:39:14 GMT
                    Server: Werkzeug/3.1.3 Python/3.11.7

                    Visit count: 1
```
---

## **Task 2: ConfigMap Implementation**  

### **Step 4: Deploy the Changes**
```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\k8s> helm upgrade app-python app-python
Release "app-python" has been upgraded. Happy Helming!
NAME: app-python
LAST DEPLOYED: Sun Mar  10 1:00:50 2025
NAMESPACE: default
STATUS: deployed
REVISION: 8
```

---
### **Retrieve the List of Pods**
```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\k8s> kubectl get po
NAME                            READY   STATUS    RESTARTS   AGE
app-python-76fb5f95f7-b5t67      1/1     Running   0          5m
app-python-76fb5f95f7-nswvq      1/1     Running   0          5m
app-python-76fb5f95f7-pdkw8      1/1     Running   0          5m
```

### **Check if ConfigMap is Mounted in the Pod**
```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\k8s> kubectl exec -it app-python-76fb5f95f7-b5t67 -- ls /config
config.json
```

```powershell
PS C:\Users\bakin\PycharmProjects\S25-devops-engineering-labs\k8s> kubectl exec -it app-python-76fb5f95f7-b5t67 -- cat /config/config.json
{
  "app_name": "Moscow Time App",
  "version": "1.0",
  "maintainer": "bakinasa"
}
```
