# Kubernetes ConfigMaps

## Task 2

I created config.json with some key-value pairs, created configmap.yaml, and updated accordingly values.yaml and deployment.yaml files. Then I installed and accessed Python application as in previous lab:

```bash
gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ helm secrets install python-time-app ./python-time-app -n default -f ./secrets.yaml

NAME: python-time-app
LAST DEPLOYED: Sun Mar  9 15:56:03 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=python-time-app,app.kubernetes.io/instance=python-time-app" -o jsonpath="{.items[0].metadata.name}")
  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT
removed './secrets.yaml.dec'

gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl get pods

NAME                                    READY   STATUS    RESTARTS        AGE
python-time-app-7b5988c768-89z8q        1/1     Running   0               46s
vault-0                                 1/1     Running   4 (4m42s ago)   2d19h
vault-agent-injector-66f45b5fd5-vtrdr   1/1     Running   4 (4m42s ago)   2d19h

gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl exec python-time-app-7b5988c768-89z8q -- cat /config.json

{
    "name": "Gleb Bugaev",
    "age": "20"
}
```

---

## Bonus Task

Firstly, I done the same thing for the Scala application:

```bash
gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ helm install scala-time-app ./scala-time-app -n default

NAME: scala-time-app
LAST DEPLOYED: Sun Mar  9 17:10:07 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=scala-time-app,app.kubernetes.io/instance=scala-time-app" -o jsonpath="{.items[0].metadata.name}")
  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT

gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl get pods

NAME                                    READY   STATUS    RESTARTS      AGE
scala-time-app-7bbcf4579-fdt8z          1/1     Running   0             46s
vault-0                                 1/1     Running   4 (78m ago)   2d20h
vault-agent-injector-66f45b5fd5-vtrdr   1/1     Running   4 (78m ago)   2d20h

gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl exec scala-time-app-7bbcf4579-fdt8z -- cat /config.json

{
    "name": "Gleb Bugaev",
    "age": "20"
}
```

Then, I utilized configmap via environment variables for both Python application:

```bash
gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl exec python-time-app-7b5988c768-vkxds -- printenv

PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOSTNAME=python-time-app-7b5988c768-vkxds
config.json=
{
    "name": "Gleb Bugaev",
    "age": "20"
}
MY_PASS=my_pass
AUTHOR=gleb
COURSE=DevOps-S25
PYTHON_TIME_APP_PORT=tcp://10.104.117.90:80
KUBERNETES_PORT_443_TCP_PORT=443
KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1
VAULT_SERVICE_HOST=10.99.138.70
VAULT_PORT_8200_TCP_PORT=8200
PYTHON_TIME_APP_SERVICE_PORT=80
VAULT_SERVICE_PORT=8200
KUBERNETES_SERVICE_PORT=443
KUBERNETES_PORT_443_TCP_PROTO=tcp
VAULT_PORT_8200_TCP_PROTO=tcp
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT=443
SCALA_TIME_APP_SERVICE_PORT_HTTP=80
SCALA_TIME_APP_PORT=tcp://10.98.121.74:80
PYTHON_TIME_APP_PORT_80_TCP_PROTO=tcp
PYTHON_TIME_APP_PORT_80_TCP_PORT=80
SCALA_TIME_APP_SERVICE_PORT=80
PYTHON_TIME_APP_SERVICE_PORT_HTTP=80
KUBERNETES_SERVICE_PORT_HTTPS=443
VAULT_PORT_8201_TCP_ADDR=10.99.138.70
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_ADDR=10.103.170.133
PYTHON_TIME_APP_PORT_80_TCP_ADDR=10.104.117.90
VAULT_PORT_8200_TCP=tcp://10.99.138.70:8200
VAULT_PORT_8200_TCP_ADDR=10.99.138.70
VAULT_PORT_8201_TCP_PORT=8201
KUBERNETES_SERVICE_HOST=10.96.0.1
VAULT_SERVICE_PORT_HTTPS_INTERNAL=8201
VAULT_PORT=tcp://10.99.138.70:8200
VAULT_AGENT_INJECTOR_SVC_SERVICE_HOST=10.103.170.133
VAULT_AGENT_INJECTOR_SVC_PORT=tcp://10.103.170.133:443
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PORT=443
SCALA_TIME_APP_PORT_80_TCP=tcp://10.98.121.74:80
SCALA_TIME_APP_PORT_80_TCP_PORT=80
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT_HTTPS=443
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PROTO=tcp
SCALA_TIME_APP_SERVICE_HOST=10.98.121.74
SCALA_TIME_APP_PORT_80_TCP_ADDR=10.98.121.74
VAULT_PORT_8201_TCP_PROTO=tcp
KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443
VAULT_SERVICE_PORT_HTTP=8200
VAULT_PORT_8201_TCP=tcp://10.99.138.70:8201
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP=tcp://10.103.170.133:443
SCALA_TIME_APP_PORT_80_TCP_PROTO=tcp
PYTHON_TIME_APP_SERVICE_HOST=10.104.117.90
PYTHON_TIME_APP_PORT_80_TCP=tcp://10.104.117.90:80
KUBERNETES_PORT=tcp://10.96.0.1:443
LANG=C.UTF-8
GPG_KEY=7169605F62C751356D054A26A821E680E5FA6305
PYTHON_VERSION=3.12.8
PYTHON_SHA256=c909157bb25ec114e5869124cc2a9c4a4d4c1e957ca4ff553f1edc692101154e
FLASK_APP=app.py
HOME=/home/python_user
```

And Scala application:

```bash
gleb@gleb-VMware-Virtual-Platform:~/Desktop/DevOps/Labs/S25-core-course-labs/k8s$ kubectl exec scala-time-app-7bbcf4579-fdt8z -- printenv

PATH=/usr/local/openjdk-17/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOSTNAME=scala-time-app-7bbcf4579-fdt8z
config.json=
{
    "name": "Gleb Bugaev",
    "age": "20"
}
AUTHOR=gleb
COURSE=DevOps-S25
KUBERNETES_SERVICE_PORT_HTTPS=443
VAULT_PORT_8200_TCP_PORT=8200
SCALA_TIME_APP_SERVICE_PORT=80
KUBERNETES_PORT=tcp://10.96.0.1:443
VAULT_AGENT_INJECTOR_SVC_SERVICE_HOST=10.103.170.133
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP=tcp://10.103.170.133:443
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PORT=443
KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1
VAULT_PORT_8200_TCP=tcp://10.99.138.70:8200
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_ADDR=10.103.170.133
VAULT_AGENT_INJECTOR_SVC_PORT_443_TCP_PROTO=tcp
VAULT_SERVICE_PORT_HTTP=8200
VAULT_SERVICE_PORT_HTTPS_INTERNAL=8201
VAULT_PORT=tcp://10.99.138.70:8200
VAULT_PORT_8201_TCP_ADDR=10.99.138.70
KUBERNETES_SERVICE_PORT=443
VAULT_PORT_8200_TCP_PROTO=tcp
VAULT_PORT_8201_TCP_PROTO=tcp
VAULT_AGENT_INJECTOR_SVC_PORT=tcp://10.103.170.133:443
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT_HTTPS=443
SCALA_TIME_APP_SERVICE_HOST=10.98.121.74
KUBERNETES_SERVICE_HOST=10.96.0.1
KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443
VAULT_SERVICE_HOST=10.99.138.70
VAULT_PORT_8201_TCP=tcp://10.99.138.70:8201
SCALA_TIME_APP_PORT_80_TCP=tcp://10.98.121.74:80
SCALA_TIME_APP_PORT_80_TCP_PROTO=tcp
SCALA_TIME_APP_PORT_80_TCP_ADDR=10.98.121.74
KUBERNETES_PORT_443_TCP_PROTO=tcp
KUBERNETES_PORT_443_TCP_PORT=443
VAULT_PORT_8201_TCP_PORT=8201
SCALA_TIME_APP_SERVICE_PORT_HTTP=80
SCALA_TIME_APP_PORT_80_TCP_PORT=80
VAULT_SERVICE_PORT=8200
VAULT_PORT_8200_TCP_ADDR=10.99.138.70
VAULT_AGENT_INJECTOR_SVC_SERVICE_PORT=443
SCALA_TIME_APP_PORT=tcp://10.98.121.74:80
JAVA_HOME=/usr/local/openjdk-17
LANG=C.UTF-8
JAVA_VERSION=17.0.2
JAVA_OPTS=
HOME=/home/scala_user
```

---
