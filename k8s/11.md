# Task 1: Kubernetes Secrets and Resource Management

## 1. Creating a Secret Using kubectl

Command used to create a secret:
```bash
kubectl create secret generic app-secret --from-literal=username=admin --from-literal=password=supersecret123
```

## 2. Verifying and Decoding the Secret

Getting the secret:
```bash
kubectl get secret app-secret -o yaml
```

Output:
```yaml
apiVersion: v1
data:
  password: c3VwZXJzZWNyZXQxMjM=
  username: YWRtaW4=
kind: Secret
metadata:
  creationTimestamp: "2025-03-23T19:35:17Z"
  name: app-secret
  namespace: default
  resourceVersion: "10934"
  uid: d364f658-9038-4864-890f-d509c9f7fd69
type: Opaque
```

Decoding the secret:
```bash
echo "Username: $(kubectl get secret app-secret -o jsonpath='{.data.username}' | base64 --decode)"
echo "Password: $(kubectl get secret app-secret -o jsonpath='{.data.password}' | base64 --decode)"
```

Output:
```
Username: admin
Password: supersecret123
```

## 3. Managing Secrets with Helm

I created a `secrets.yaml` file in the templates folder with a Secret object definition, and updated the Deployment to include environment variables from this secret.

### Pod List
```bash
kubectl get pods
```

Output:
```
NAME                                           READY   STATUS    RESTARTS   AGE
demo-python-app-chart-6f877dcb5-7wcj9          1/1     Running   0          38s
demo-python-app-chart-6f877dcb5-gj4vx          1/1     Running   0          38s
demo-python-app-chart-6f877dcb5-rw2g8          1/1     Running   0          38s
```

### Verifying Secrets in the Pod
```bash
kubectl exec demo-python-app-chart-6f877dcb5-7wcj9 -- printenv | grep APP_
```

Output:
```
APP_USERNAME=admin
APP_PASSWORD=supersecret123
```

This confirms that our secrets were successfully mounted as environment variables in the pod.

# Task 2: Vault Secret Management System

## 1. Installing and Configuring Vault

I attempted to install Vault using Helm but encountered issues with image pulling and connectivity. I created a vault-dev.yaml file with the necessary Vault configuration for development mode, including:

- Vault server in dev mode
- Kubernetes authentication
- Service account configuration
- Secret paths and policies

## 2. Configuring Vault Integration in the Helm Chart

I updated the deployment template to include the necessary annotations for Vault integration:

```yaml
vault.hashicorp.com/agent-inject: "true"
vault.hashicorp.com/role: "myapp"
vault.hashicorp.com/agent-inject-secret-config.txt: "secret/data/myapp/config"
vault.hashicorp.com/agent-inject-template-config.txt: | 
  {{- with secret "secret/data/myapp/config" -}}
  export DB_USERNAME={{ .Data.data.username }}
  export DB_PASSWORD={{ .Data.data.password }}
  {{- end -}}
```

I also updated the values.yaml file to include a configuration option for Vault integration that can be enabled when Vault is properly set up:

```yaml
# Vault integration
vault:
  enabled: false  # Set to true when Vault is properly set up
```

Due to issues with deploying Vault in the Kubernetes environment, we could not complete the full Vault secret injection demonstration. However, the configurations are in place to enable this functionality when the Vault service is properly deployed. 