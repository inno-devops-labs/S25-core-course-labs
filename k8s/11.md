# Kubernetes secrets report

## Creating the secret manually

```sh
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- create secret generic my-secret --from-literal=pass=password123
secret/my-secret created
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- get secrets
NAME                               TYPE                 DATA   AGE
my-secret                          Opaque               1      37s
sh.helm.release.v1.helm-hooks.v1   helm.sh/release.v1   1      6d22h
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- get secret my-secret -o jsonpath='{.data}'
{"pass":"cGFzc3dvcmQxMjM="}
tedor49@tedor49:~/S25-core-course-labs/k8s$ echo cGFzc3dvcmQxMjM= | base64 --decode
password123
```

## Storing the secret with helm

```sh
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- get po
NAME                                         READY   STATUS    RESTARTS      AGE
helm-hooks-python-msk-time-549454c49-v68nb   1/1     Running   1 (38m ago)   6d23h
python-msk-time-74dcd95bb8-zfq2c             1/1     Running   0             37s
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- exec python-msk-time-74dcd95bb8-zfq2c -- printenv | grep MY_PASS
MY_PASS=password123
```

## Using Hashicorp Vault

### Without template

```sh
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- get pods
NAME                                    READY   STATUS    RESTARTS   AGE
python-msk-time-76546b66dd-kdnbc        2/2     Running   0          76s
vault-0                                 1/1     Running   0          16m
vault-agent-injector-7d4444bc8b-lvrzm   1/1     Running   0          16m
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- exec python-msk-time-76546b66dd-kdnbc -- cat /vault/secrets/database-config.txt
Defaulted container "python-msk-time" out of: python-msk-time, vault-agent, vault-agent-init (init)
data: map[password:password123]
metadata: map[created_time:2025-03-09T17:33:06.347133246Z custom_metadata:<nil> deletion_time: destroyed:false version:1]
```

### With template added and minor tweaks

```sh
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- get pods
NAME                                    READY   STATUS    RESTARTS   AGE
python-msk-time-7c5d764bb-zwf8c         2/2     Running   0          50s
vault-0                                 1/1     Running   0          43m
vault-agent-injector-7d4444bc8b-lvrzm   1/1     Running   0          43m
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- exec python-msk-time-7c5d764bb-zwf8c -- cat /vault/secrets/credentials.txt
Defaulted container "python-msk-time" out of: python-msk-time, vault-agent, vault-agent-init (init)
password:password123
tedor49@tedor49:~/S25-core-course-labs/k8s$ minikube kubectl -- exec python-msk-time-7c5d764bb-zwf8c -- cat /vault/secrets/credentialsraw.txt
Defaulted container "python-msk-time" out of: python-msk-time, vault-agent, vault-agent-init (init)
data: map[password:password123]
metadata: map[created_time:2025-03-09T17:33:06.347133246Z custom_metadata:<nil> deletion_time: destroyed:false version:1]
```
