# Kubernetes Secrets and Resource Management

## Task 1: Kubernetes Secrets

### Secret Verification
```bash
# Создание и проверка базового секрета
$ kubectl create secret generic flask-app-secret --from-literal=MY_PASSWORD=my-secure-password
secret/flask-app-secret created

$ kubectl get secret flask-app-secret -o jsonpath='{.data.MY_PASSWORD}' | base64 --decode
my-secure-password

# Проверка секрета в поде
$ kubectl exec -it <pod-name> -- printenv | grep MY_PASSWORD
MY_PASSWORD=my-secure-password
```

## Task 2: Vault Integration

### Vault Status
```bash
# Проверка статуса подов
$ kubectl get pods
NAME                     READY   STATUS    RESTARTS   AGE
vault-6987c95f79-lfmvt   1/1     Running   0         32s
vault-init-c4957         0/1     Completed   0         32s

# Проверка состояния Vault
$ kubectl exec -it vault-6987c95f79-lfmvt -- sh -c "VAULT_ADDR=http://127.0.0.1:8200 VAULT_TOKEN=root vault status"
Key             Value
---             -----
Seal Type       shamir
Initialized     true
Sealed          false
Total Shares    1
Threshold       1
Version         1.13.3
Build Date      2023-06-06T18:12:37Z
Storage Type    inmem
Cluster Name    vault-cluster-88bdd510
Cluster ID      efafcbb8-84c3-35ee-1496-66c908c83c4e
HA Enabled      false
```

### Vault Secret Management
```bash
# Создание и получение секрета в Vault
$ kubectl exec -it vault-6987c95f79-lfmvt -- sh -c "VAULT_ADDR=http://127.0.0.1:8200 VAULT_TOKEN=root vault kv get secret/myapp/config"
====== Secret Path ======
secret/data/myapp/config

======= Metadata =======
Key                Value
---                -----
created_time       2025-03-09T17:19:30.381966069Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            1

====== Data ======
Key         Value
---         -----
password    my-vault-password

# Проверка доступа к секретам Vault
$ kubectl exec -it vault-6987c95f79-lfmvt -- sh -c "VAULT_ADDR=http://127.0.0.1:8200 VAULT_TOKEN=root vault secrets list"
Path          Type         Accessor              Description
----          ----         --------              -----------
cubbyhole/    cubbyhole    cubbyhole_*****      per-token private secret storage
identity/     identity     identity_*****        identity store
secret/       kv           kv_*****             key/value secret storage
sys/          system       system_*****         system endpoints used for control
```

## Task 3: Resource Management

### Pod Resources Configuration
```bash
# Статус подов с настроенными ресурсами
$ kubectl get pods
NAME                                READY   STATUS    RESTARTS   AGE
myapp-deployment-7d59669b67-x8k9f   1/1     Running   0          45s

# Проверка настроек ресурсов
$ kubectl describe pod myapp-deployment-7d59669b67-x8k9f | grep -A6 Resources:
Resources:
  Limits:
    cpu: 500m
    memory: 512Mi
  Requests:
    cpu: 200m
    memory: 256Mi

# Проверка использования ресурсов
$ kubectl top pod myapp-deployment-7d59669b67-x8k9f
NAME                                CPU(cores)   MEMORY(bytes)
myapp-deployment-7d59669b67-x8k9f   15m         45Mi
```

### Helm Deployment Status
```bash
$ helm list
NAME    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART           APP VERSION
myapp   default         2               2025-03-09 20:23:15.000000 +0000 UTC   deployed        myapp-0.1.0     1.16.0
``` 