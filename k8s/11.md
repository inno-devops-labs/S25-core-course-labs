# Kubernetes Secrets

## Task 1

### Create and decode secret

```bash
azeeez@azeeez:~/Desktop/courses/devops/kdi/S25-core-course-labs/k8s$ kubectl create secret generic lab-11 --from-literal=TEST=testsecret
secret/lab-11 created

azeeez@azeeez:~/Desktop/courses/devops/kdi/S25-core-course-labs/k8s$ kubectl get secret lab-11 -o yaml
apiVersion: v1
data:
  TEST: dGVzdHNlY3JldA==
kind: Secret
metadata:
  creationTimestamp: "2025-03-09T11:54:08Z"
  name: lab-11
  namespace: default
  resourceVersion: "506"
  uid: c7043ffb-61da-465f-bd7e-daa3b109fd63
type: Opaque

azeeez@azeeez:~/Desktop/courses/devops/kdi/S25-core-course-labs/k8s$ echo "dGVzdHNlY3JldA==" | base64 --decode
testsecret
```

### Installing secret

```bash
azeeez@azeeez:~/Desktop/courses/devops/kdi/S25-core-course-labs/k8s$ helm secrets install python-app ./python-app -n default -f ./secrets.yaml

[helm-secrets] Decrypt: ./secrets.yaml
NAME: python-app
LAST DEPLOYED: Sun Mar  9 15:39:01 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=python-app,app.kubernetes.io/instance=python-app" -o jsonpath="{.items[0].metadata.name}")
  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT
[helm-secrets] Removed: ./secrets.yaml.dec
```

### `grep` the secret

```bash
azeeez@azeeez:~/Desktop/courses/devops/kdi/S25-core-course-labs/k8s$ kubectl exec python-app-cb9b974c5-89tbf -- printenv | grep TEST
TEST=testsecret
```
