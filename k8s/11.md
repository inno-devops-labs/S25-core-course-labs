# Lab 11: Kubernetes Secrets and Hashicorp Vault

## Task 1

### `kubectl get secrets my-secret`

```sh
NAME        TYPE     DATA   AGE
my-secret   Opaque   2      6s
leha@Laptop:/mnt/c/Users/frost/PycharmProjects/S25-core-course-labs/k8s/my-app$   kubectl get secret my-secret -o yaml
apiVersion: v1
data:
  password: bXlQYXNzd29yZA==
  username: bXlVc2Vy
kind: Secret
metadata:
  creationTimestamp: "2025-03-09T09:11:56Z"
  name: my-secret
  namespace: default
  resourceVersion: "11286"
  uid: afb8ae6e-948a-4b62-b62c-17bf0fd1dfc7
type: Opaque
```

### echo 'bXlQYXNzd29yZA==' | base64 --decode

```sh
myPassword
```

### `kubectl exec my-app-5cbccb9d58-c9bk9 --printenv | grep USERNAME`

```sh
USERNAME=myUser
```

## Task 2

### `kubectl exec -it my-app-6bc999b9cc-hc4zt -- sh`

```sh
Defaulted container "my-app" out of: my-app, my-container, vault-agent, vault-agent-init (init)
/app $ ls
app               app.log           requirements.txt
/app $ cat /vault/secrets/database-config.txt
data: map[password:myPass username:myUser]
metadata: map[created_time:2025-03-09T10:40:49.471837561Z custom_metadata:<nil> deletion_time: destroyed:false version:1]
/app $ df -h
Filesystem                Size      Used Available Use% Mounted on
overlay                1006.9G      6.9G    948.8G   1% /
tmpfs                    64.0M         0     64.0M   0% /dev
tmpfs                     7.7G         0      7.7G   0% /sys/fs/cgroup
shm                      64.0M         0     64.0M   0% /dev/shm
tmpfs                    15.5G      4.0K     15.5G   0% /vault/secrets
/dev/sde               1006.9G      6.9G    948.8G   1% /dev/termination-log
/dev/sde               1006.9G      6.9G    948.8G   1% /etc/resolv.conf
/dev/sde               1006.9G      6.9G    948.8G   1% /etc/hostname
/dev/sde               1006.9G      6.9G    948.8G   1% /etc/hosts
tmpfs                    15.5G     12.0K     15.5G   0% /run/secrets/kubernetes.io/serviceaccount
tmpfs                     7.7G         0      7.7G   0% /proc/acpi
tmpfs                    64.0M         0     64.0M   0% /proc/kcore
tmpfs                    64.0M         0     64.0M   0% /proc/keys
tmpfs                    64.0M         0     64.0M   0% /proc/timer_list
tmpfs                     7.7G         0      7.7G   0% /sys/firmware
```
