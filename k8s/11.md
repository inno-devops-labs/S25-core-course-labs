# Kubernetes Secrets

## Step 1

```bash
   PS C:\Users\Elizoveta\Desktop\S25-core-course-labs>    kubectl create secret generic my-secret --from-literal=MY_PASS=mysecretpassword secret/my-secret created
```

## Step 2

```bash 
   PS C:\Users\Elizoveta\Desktop\S25-core-course-labs>    kubectl get secret my-secret -o yaml
    apiVersion: v1
    data:
    MY_PASS: bXlzZWNyZXRwYXNzd29yZA==
    kind: Secret
    metadata:
    creationTimestamp: "2025-03-03T18:16:06Z"
    name: my-secret
    namespace: default
    resourceVersion: "16127"
    uid: d14619b9-a76d-46b0-9097-1604b8dbba20
    type: Opaque
```

## Step 3

```bash
    PS C:\Users\Elizoveta\Desktop\S25-core-course-labs> [System.Text.Encoding]::UTF8.GetString(    [System.Convert]::FromBase64String("bXlzZWNyZXRwYXNzd29yZA=="))
    mysecretpassword
```

## Step 4

```bash
    PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s>    kubectl get pods
    NAME                                READY   STATUS    RESTARTS   AGE
    helm-hooks-myapp-59dfc7df48-c7pql   1/1     Running   0          4m12s
```

## Step 5

```bash
    PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s>   kubectl exec helm-hooks-myapp-59dfc7df48-c7pql -- printenv | findstr MY_PASS      
    MY_PASS=mysecretpassword
```

## Task 2. Step 1

```bash
PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s> helm install vault hashicorp/vault --set "server.dev.enabled=true"
NAME: vault
LAST DEPLOYED: Tue Mar  4 11:56:06 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
Thank you for installing HashiCorp Vault!

Now that you have deployed Vault, you should look over the docs on using
Vault with Kubernetes available here:

https://developer.hashicorp.com/vault/docs


Your release is named vault. To learn more about the release, try:

  $ helm status vault
  $ helm get manifest vault
```

## Task 2. Step 2

```bash
PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s> kubectl get pods
NAME                                    READY   STATUS              RESTARTS   AGE
helm-hooks-myapp-59dfc7df48-c7pql       1/1     Running             0          9m38s
vault-0                                 0/1     ContainerCreating   0          15s
vault-agent-injector-66f45b5fd5-szgkj   0/1     ContainerCreating   0          15s
```

## Task 2. Step 3

```bashPS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s> vault auth enable kubernetes
Success! Enabled kubernetes auth method at: kubernetes/
```

## Task 2. Step 4

```bash
PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s> vault write auth/kubernetes/config kubernetes_host=https://192.168.49.2:8443 kubernetes_ca_cert=@C:\Users\Elizoveta\.minikube\ca.crt  
Success! Data written to: auth/kubernetes/config
```

## Task 2. Step 5

```bash
PS C:\Users\Elizoveta\Desktop\S25-core-course-labs\k8s> vault write auth/kubernetes/role/my-app-role bound_service_account_names=userliza bound_service_account_namespaces=default policies=my-app-policy ttl=24h
Success! Data written to: auth/kubernetes/role/my-app-role
```