# Kubernetes StatefulSet

## Kubernetes Resource Overview

```bash
kubectl get po,sts,svc,pvc
```

Command output:

```bash
NAME                         READY   STATUS    RESTARTS   AGE
pod/app-stateful-0           1/1     Running   0          10m
pod/app-stateful-1           1/1     Running   0          10m

NAME                            READY   AGE
statefulset.apps/app-stateful   2/2     10m

NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/app-stateful         ClusterIP   None            <none>        8000/TCP         10m
service/app-stateful-svc     ClusterIP   10.107.65.239   <none>        8000/TCP         10m

NAME                                                     STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/app-stateful-data-app-stateful-0   Bound    pvc-32164d07-d1b8-452d-a895-082dfbbbfc2e   5Gi        RWO            standard       10m
persistentvolumeclaim/app-stateful-data-app-stateful-1   Bound    pvc-70179ee1-e140-432d-8623-c9451baba06b   5Gi        RWO            standard       10m
```

## File Persistence and Visits Count Verification

```bash
kubectl exec pod/app-stateful-0 -- cat visits
```

Command output:

```bash
42
```

```bash
kubectl exec pod/app-stateful-1 -- cat visits
```

Command output:

```bash
42
```

Both pods show the same visit count (```42```), indicating that the data was initialized identically. Each pod gets its own PVC, so the similar output shows that the application logic is consistent across replicas.

## Headless Service and DNS Resolution

The DNS resolution confirms that pod app-stateful-1 is reachable through the headless service domain name.
This setup is essential for stateful applications that require stable network identities.

## Monitoring & Alerts: Liveness and Readiness Probes

- Liveness Probe:
Restarts the pod if it becomes unhealthy (e.g., if the ```/health``` endpoint fails), ensuring that failed pods do not remain in service.
- Readiness Probe:
Prevents traffic from being routed to a pod until it is fully ready to handle requests (ensuring the ```/ready``` endpoint returns a positive status).

These probes are critical for stateful applications, as they help maintain service availability and ensure that only healthy pods receive traffic.

## Ordering Guarantee and Parallel Operations

By default, StatefulSets launch pods in an ordered, sequential manner (OrderedReady). This can be useful for apps that require ordered startup; however, our Python app does not depend on order.

With ```Parallel``` mode, all pods are created or terminated simultaneously rather than sequentially.
For the app, ordering guarantees are unnecessary because each replica functions independently; hence, parallel operations speed up scaling and termination.