**Lab 14: Kubernetes StatefulSet**

**Outputs of Commands:**

1. **Pods, StatefulSets, Services, and PersistentVolumeClaims:**

   ```bash
   kubectl get po,sts,svc,pvc
   ```

   Output:

2. **Accessing the Application via Minikube:**

   ```bash
   minikube service demo
   ```

   Output:

3. **Content Verification in Each Pod:**

   ```bash
   kubectl exec pod/demo-0 -- cat /data/visits
   kubectl exec pod/demo-1 -- cat /data/visits
   kubectl exec pod/demo-2 -- cat /data/visits
   ```

   Outputs:

   *Explanation:* Each pod maintains its own count of visits, stored in its respective persistent volume. This isolation ensures data consistency and integrity across replicas.

**Persistent Storage Validation:**

1. **Deleting a Pod:**

   ```bash
   kubectl delete pod demo-0
   ```

   Output:

2. **Verifying PVC and Data Persistence:**

   ```bash
   kubectl get pvc
   kubectl exec demo-0 -- cat /data/visits
   ```

   Outputs:

   *Explanation:* After deletion, `demo-0` was recreated, retaining its data due to the persistent volume claim, confirming data persistence.

**Headless Service Access:**

1. **DNS Resolution Between Pods:**

   ```bash
   kubectl exec demo-0 -- nslookup demo-1.demo
   ```

   Output:

   *Explanation:* The headless service enables direct DNS-based communication between pods, facilitating stateful applications' inter-pod interactions.

**Monitoring & Alerts:**

1. **Liveness and Readiness Probes:**

   ```yaml
   livenessProbe:
     httpGet:
       path: /healthz
       port: 8080
     initialDelaySeconds: 30
     periodSeconds: 10
   readinessProbe:
     httpGet:
       path: /ready
       port: 8080
     initialDelaySeconds: 5
     periodSeconds: 10
   ```

   *Explanation:* Liveness probes ensure the application is running; if it fails, Kubernetes restarts the pod. Readiness probes confirm the application is ready to serve traffic, preventing requests from being sent to unready pods. These probes are vital for maintaining the health and reliability of stateful applications.

**Ordering Guarantee and Parallel Operations:**

1. **Necessity of Ordering Guarantees:**

   *Explanation:* For this application, strict ordering guarantees are unnecessary. Each pod operates independently, and their startup sequence doesn't impact functionality.

2. **Implementing Parallel Launch and Termination:**

   ```yaml
   podManagementPolicy: Parallel
   ```

   *Explanation:* Setting `podManagementPolicy` to `Parallel` allows the StatefulSet controller to create or terminate all pods simultaneously, reducing deployment and scaling times. This approach is suitable when pod ordering isn't critical to the application's operation. citeturn0search0 