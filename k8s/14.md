## Task 1

```sh
@Damncaf-goin-crazy ➜ /workspaces/S25-core-course-labs (hw13) $ helm install --dry-run --debug my-release k8s/my-helm-chart/
install.go:224: 2025-03-13 20:17:40.535586827 +0000 UTC m=+0.042436308 [debug] Original chart version: ""
install.go:241: 2025-03-13 20:17:40.535637023 +0000 UTC m=+0.042486492 [debug] CHART PATH: /workspaces/S25-core-course-labs/k8s/my-helm-chart

NAME: my-release
LAST DEPLOYED: Thu Mar 13 20:17:40 2025
NAMESPACE: default
STATUS: pending-install
REVISION: 1
USER-SUPPLIED VALUES:
{}

COMPUTED VALUES:
affinity: {}
autoscaling:
  enabled: false
  maxReplicas: 3
  minReplicas: 1
  targetCPUUtilizationPercentage: 80
fullnameOverride: ""
image:
  pullPolicy: IfNotPresent
  repository: nginx
  tag: ""
imagePullSecrets: []
ingress:
  annotations: {}
  className: ""
  enabled: false
  hosts:
  - host: chart-example.local
    paths:
    - path: /
      pathType: ImplementationSpecific
  tls: []
livenessProbe:
  httpGet:
    path: /
    port: 80
  initialDelaySeconds: 10
  periodSeconds: 5
nameOverride: ""
nodeSelector: {}
persistence:
  accessModes:
  - ReadWriteOnce
  enabled: true
  size: 5Gi
  storageClass: ""
podAnnotations: {}
podLabels: {}
podSecurityContext: {}
readinessProbe:
  httpGet:
    path: /
    port: 80
  initialDelaySeconds: 5
  periodSeconds: 5
replicaCount: 3
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi
securityContext: {}
service:
  name: my-stateful-service
  port: 80
  type: ClusterIP
serviceAccount:
  annotations: {}
  automount: true
  create: true
  name: ""
tolerations: []
vault:
  auth:
    method: kubernetes
    role: my-app
  enabled: true
  path: secret/my-app
volumeMounts:
- mountPath: /data
  name: data
volumes:
- name: data
  persistentVolumeClaim:
    claimName: my-pvc

HOOKS:
---
# Source: my-helm-chart/templates/tests/test-connection.yaml
apiVersion: v1
kind: Pod
metadata:
  name: "my-release-my-helm-chart-test-connection"
  labels:
    helm.sh/chart: my-helm-chart-0.1.0
    app.kubernetes.io/name: my-helm-chart
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: wget
      image: busybox
      command: ['wget']
      args: ['my-release-my-helm-chart:80']
  restartPolicy: Never
MANIFEST:
---
# Source: my-helm-chart/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-release-my-helm-chart
  labels:
    helm.sh/chart: my-helm-chart-0.1.0
    app.kubernetes.io/name: my-helm-chart
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
automountServiceAccountToken: true
---
# Source: my-helm-chart/templates/vault-auth-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: vault-auth
  namespace: default
---
# Source: my-helm-chart/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-secret
type: Opaque
data:
  MY_USER: YWRtaW4=
  MY_PASS: U3VwZXJTZWNyZXQxMjM=
---
# Source: my-helm-chart/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-release-my-helm-chart
  labels:
    helm.sh/chart: my-helm-chart-0.1.0
    app.kubernetes.io/name: my-helm-chart
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 80
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: my-helm-chart
    app.kubernetes.io/instance: my-release
---
# Source: my-helm-chart/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: my-release-my-helm-chart
  labels:
    helm.sh/chart: my-helm-chart-0.1.0
    app.kubernetes.io/name: my-helm-chart
    app.kubernetes.io/instance: my-release
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  serviceName: "my-stateful-service"
  replicas: 3
  selector:
    matchLabels:
      app.kubernetes.io/name: my-helm-chart
      app.kubernetes.io/instance: my-release
  template:
    metadata:
      labels:
        helm.sh/chart: my-helm-chart-0.1.0
        app.kubernetes.io/name: my-helm-chart
        app.kubernetes.io/instance: my-release
        app.kubernetes.io/version: "1.16.0"
        app.kubernetes.io/managed-by: Helm
    spec:
      containers:
        - name: my-helm-chart
          image: "nginx:1.16.0"
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 80
          volumeMounts:
            - name: storage
              mountPath: /data
  volumeClaimTemplates:
    - metadata:
        name: storage
      spec:
        accessModes: ["ReadWriteOnce"]
        resources:
          requests:
            storage: 5Gi

NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=my-helm-chart,app.kubernetes.io/instance=my-release" -o jsonpath="{.items[0].metadata.name}")
  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT
```


# StatefulSet Exploration and Optimization

## Task 2

```sh
@Damncaf-goin-crazy ➜ /workspaces/S25-core-course-labs (hw13) $kubectl get po
ectl get pvc
NAME                                  READY   STATUS             RESTARTS       AGE
my-release-my-helm-chart-0            1/1     Running            0              2m15s
my-release-my-helm-chart-1            1/1     Running            0              119s
my-release-my-helm-chart-2            1/1     Running            0              115s
pre-install-job-j89vn                 0/1     Completed          0              4h
python-app-your-app-b9b4c7869-ndqqr   0/1     Running            28 (15s ago)   3h48m
python-app-your-app-b9b4c7869-swgkk   0/1     CrashLoopBackOff   31 (24s ago)   3h59m

@Damncaf-goin-crazy ➜ /workspaces/S25-core-course-labs (hw13) $ kubectl get sts
NAME                       READY   AGE
my-release-my-helm-chart   3/3     2m15s

@Damncaf-goin-crazy ➜ /workspaces/S25-core-course-labs (hw13) $ kubectl get svc
NAME                       TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE
kubernetes                 ClusterIP   10.96.0.1        <none>        443/TCP   4h19m
my-release-my-helm-chart   ClusterIP   10.111.103.134   <none>        80/TCP    3h36m
python-app-your-app        ClusterIP   10.100.203.46    <none>        80/TCP    3h59m

@Damncaf-goin-crazy ➜ /workspaces/S25-core-course-labs (hw13) $ kubectl get pvc
NAME                                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
storage-my-release-my-helm-chart-0   Bound    pvc-431a42ff-d81c-4c74-8966-78bc6fc4c3cd   5Gi        RWO            standard       <unset>                 2m15s
storage-my-release-my-helm-chart-1   Bound    pvc-2b158893-e4fb-4e20-a9fd-f05505d1b172   5Gi        RWO            standard       <unset>                 119s
storage-my-release-my-helm-chart-2   Bound    pvc-060e0481-9172-472e-a9f4-f706d127bcac   5Gi        RWO            standard       <unset>                 115s
```