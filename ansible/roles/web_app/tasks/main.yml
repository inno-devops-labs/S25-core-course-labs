---
- name: Login Docker Hub Environment
  block:
  - name: log into docker hub registry
    docker_login:
      username: "{{ dockerhubuser }}"
      password: "{{ dockerhubpass }}"
  tags:
  - setup
- name: Login Docker Hub Environment
  block:
  - name: ensure a container is running
    docker_container:
      name: my_container
      state: started
      image: "magel0n/moscowtimeimagepython:latest"
      pull: true
      ports:
        - "5000:5000"
  tags:
  - deploy

- name: WIPE THEM ALL MUHAHAHAHHAHAH
  block:
  - name: Delete image and container
    when: web_app_full_wipe
    ansible.builtin.include_tasks: 0-wipe.yml
  tags:
  - wipe

- name: Docker-Compose
  block:
  - name: Deploy docker-compose file
    ansible.builtin.template:
      src: docker-compose.yml.j2
      dest: /docker-compose.yml
  tags:
  - docker-compose
