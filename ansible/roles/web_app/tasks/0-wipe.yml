---
- name: Remove Docker container and related files
  block:
    - name: Stop and remove container
      docker_container:
        name: "{{ web_app_container_name }}"
        state: absent
      ignore_errors: yes

    - name: Remove Docker image
      docker_image:
        name: "{{ web_app_image }}"
        state: absent
      ignore_errors: yes

    - name: Remove docker-compose file
      file:
        path: "/opt/moscow-time/docker-compose.yml"
        state: absent
      ignore_errors: yes
  when: web_app_full_wipe | default(false) | bool
  tags:
    - wipe
    - never 