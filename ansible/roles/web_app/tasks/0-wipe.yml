- name: Wipe Previous Deployment
  block:
    - name: Remove Docker Container
      command: docker-compose down
      args:
        chdir: /home/{{ ansible_user }}

    - name: Remove Docker Image
      docker_image:
        name: "{{ docker_image }}"
        state: absent

    - name: Delete Docker Files
      file:
        path: "/home/{{ ansible_user }}/docker-compose.yml"
        state: absent
  when: web_app_full_wipe | bool
  tags:
    - wipe
